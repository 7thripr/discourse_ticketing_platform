{"ast":null,"code":"import Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport LoginView from '../views/LoginView.vue';\nimport RegisterView from '../views/RegisterView.vue';\nimport store from '../store';\nimport * as common from \"../assets/common.js\";\nVue.use(VueRouter);\nconst routes = [{\n  path: '/student',\n  name: 'StudentView',\n  component: () => import('../views/StudentView.vue')\n}, {\n  path: '/support',\n  name: 'SupportView',\n  component: () => import('../views/SupportView.vue')\n}, {\n  path: '/admin',\n  name: 'AdminView',\n  component: () => import('../views/AdminView.vue')\n}, {\n  path: '/login',\n  name: 'LoginView',\n  component: LoginView,\n  alias: '/'\n}, {\n  path: '/register',\n  name: 'RegisterView',\n  component: RegisterView\n}, {\n  path: '*',\n  redirect: '/login'\n}];\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes\n});\nrouter.beforeEach((to, from, next) => {\n  // redirect to login page if not logged in and trying to access a restricted page\n  const publicPages = ['/login', '/register', '/'];\n  const authRequired = !publicPages.includes(to.path);\n  if (!store.getters.get_logged_status) {\n    store.commit('initialiseStore');\n  }\n  const logged_status = store.getters.get_logged_status;\n  console.log('Routing', from.path, to.path, authRequired, logged_status);\n  if (authRequired && !logged_status) {\n    alert(\"Token expired. Please log in again.\");\n    return next('/login');\n  }\n  if (authRequired && logged_status) {\n    const role = store.state.user.role;\n    let accesing = \"\";\n    if (common.STUDENT_ROUTES.includes(to.path)) {\n      accesing = \"student\";\n    }\n    if (common.SUPPORT_ROUTES.includes(to.path)) {\n      accesing = \"support\";\n    }\n    if (common.ADMIN_ROUTES.includes(to.path)) {\n      accesing = \"admin\";\n    }\n    console.log('Checking role: ', role, to.path, accesing);\n    if (role != accesing) {\n      alert(\"You don't have access to this page.\");\n      return next(`/${role}`);\n    }\n  }\n  next();\n});\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","LoginView","RegisterView","store","common","use","routes","path","name","component","alias","redirect","router","mode","base","process","env","BASE_URL","beforeEach","to","from","next","publicPages","authRequired","includes","getters","get_logged_status","commit","logged_status","console","log","alert","role","state","user","accesing","STUDENT_ROUTES","SUPPORT_ROUTES","ADMIN_ROUTES"],"sources":["D:/IITM_exam/IITM_Term_7/SE_Project/Tushar_Work/code/frontend/src/router/index.js"],"sourcesContent":["import Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport LoginView from '../views/LoginView.vue';\nimport RegisterView from '../views/RegisterView.vue';\nimport store from '../store';\nimport * as common from \"../assets/common.js\";\n\nVue.use(VueRouter);\n\nconst routes = [\n  {\n    path: '/student',\n    name: 'StudentView',\n    component: () => import('../views/StudentView.vue'),\n  },\n  {\n    path: '/support',\n    name: 'SupportView',\n    component: () => import('../views/SupportView.vue'),\n  },\n  {\n    path: '/admin',\n    name: 'AdminView',\n    component: () => import('../views/AdminView.vue'),\n  },\n  {\n    path: '/login',\n    name: 'LoginView',\n    component: LoginView,\n    alias: '/',\n  },\n  {\n    path: '/register',\n    name: 'RegisterView',\n    component: RegisterView,\n  },\n  { path: '*', redirect: '/login', }\n];\n\nconst router = new VueRouter({\n  mode: 'history',\n  base: process.env.BASE_URL,\n  routes,\n});\n\nrouter.beforeEach((to, from, next) => {\n  // redirect to login page if not logged in and trying to access a restricted page\n  const publicPages = ['/login', '/register', '/'];\n  const authRequired = !publicPages.includes(to.path);\n  if (!store.getters.get_logged_status){\n    store.commit('initialiseStore');\n  }\n  const logged_status = store.getters.get_logged_status;\n  \n  console.log('Routing', from.path, to.path, authRequired, logged_status);\n\n  if (authRequired && !logged_status) {\n    alert(\"Token expired. Please log in again.\");\n    return next('/login');\n  }\n  if (authRequired && logged_status) {\n    const role = store.state.user.role;\n    \n    let accesing = \"\";\n    if (common.STUDENT_ROUTES.includes(to.path)) { accesing = \"student\"}\n    if (common.SUPPORT_ROUTES.includes(to.path)) { accesing = \"support\"}\n    if (common.ADMIN_ROUTES.includes(to.path)) { accesing = \"admin\"}\n    console.log('Checking role: ', role, to.path, accesing);\n    if (role != accesing){\n    alert(\"You don't have access to this page.\");\n    return next(`/${role}`);\n    }\n  }\n  next();\n})\n\n\nexport default router;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}